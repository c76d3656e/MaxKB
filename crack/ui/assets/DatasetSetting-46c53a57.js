import{cr as P,dk as Y,cZ as Z,cs as u,c_ as H,cq as v,cu as J,cv as r,cS as O,cy as d,cG as _,cB as s,cC as l,cA as o,cw as Q,cz as q,cK as p,eg as W,dj as X,cL as b,cM as f,di as j,cD as ee,cE as te,cI as ae,dq as se,cY as le,e1 as k,de as S,cP as oe}from"./index-a6cfd98b.js";const ne={class:"dataset-setting main-calc-height"},re={class:"p-24"},de={class:"title-decoration-1 mb-16"},ie={class:"flex align-center"},ce={class:"flex align-center"},ue={key:0},_e={class:"title-decoration-1 mb-16"},pe={class:"flex-between"},me={class:"flex align-center"},ve=["src"],fe={class:"text-right"},ge=P({__name:"DatasetSetting",setup(ye){const M=Y(),{params:{id:g}}=M,{dataset:z}=Z(),B=u(),y=u(),h=u(!1),c=u({}),C=u([]),w=u([]),V=u(""),n=u({source_url:"",selector:""}),I=H({source_url:[{required:!0,message:v("views.dataset.datasetForm.form.source_url.requiredMessage"),trigger:"blur"}]});async function R(){var t;await((t=y.value)==null?void 0:t.validate())&&await B.value.validate(a=>{if(a){const i=c.value.type==="1"?{application_id_list:w.value,meta:n.value,...y.value.form}:{application_id_list:w.value,...y.value.form};V.value!==y.value.form.embedding_mode_id?le(v("common.tip"),v("views.dataset.tip.updateModeMessage"),{confirmButtonText:v("views.dataset.setting.vectorization")}).then(()=>{k.putDataset(g,i,h).then(m=>{k.putReEmbeddingDataset(g).then(()=>{S(v("common.saveSuccess"))})})}).catch(()=>{}):k.putDataset(g,i,h).then(m=>{S(v("common.saveSuccess"))})}})}function T(){z.asyncGetDatasetDetail(g,h).then(t=>{var a,i;c.value=t.data,V.value=(a=t.data)==null?void 0:a.embedding_mode_id,c.value.type==="1"&&(n.value=t.data.meta),w.value=(i=t.data)==null?void 0:i.application_id_list,k.listUsableApplication(g,h).then(m=>{C.value=m.data})})}return J(()=>{T()}),(t,a)=>{const i=r("AppAvatar"),m=r("el-text"),$=r("el-card"),F=r("el-form-item"),A=r("el-input"),L=r("el-form"),N=r("el-col"),E=r("el-row"),U=r("el-button"),G=r("el-scrollbar"),x=r("LayoutContainer"),K=O("loading");return d(),_(x,{header:t.$t("common.setting")},{default:s(()=>[l("div",ne,[o(G,null,{default:s(()=>[Q((d(),q("div",re,[l("h4",de,p(t.$t("views.dataset.datasetForm.title.info")),1),o(W,{ref_key:"BaseFormRef",ref:y,data:c.value},null,8,["data"]),o(L,{ref_key:"webFormRef",ref:B,rules:I,model:n.value,"label-position":"top","require-asterisk-position":"right"},{default:s(()=>[o(F,{label:t.$t("views.dataset.datasetForm.form.datasetType.label"),required:""},{default:s(()=>{var e;return[c.value.type==="0"?(d(),_($,{key:0,shadow:"never",class:"mb-8",style:{width:"50%"}},{default:s(()=>[l("div",ie,[o(i,{class:"mr-8 avatar-blue",shape:"square",size:32},{default:s(()=>a[4]||(a[4]=[l("img",{src:X,style:{width:"58%"},alt:""},null,-1)])),_:1}),l("div",null,[l("div",null,p(t.$t("views.dataset.general")),1),o(m,{type:"info"},{default:s(()=>[b(p(t.$t("views.dataset.datasetForm.form.datasetType.generalInfo")),1)]),_:1})])])]),_:1})):f("",!0),((e=c.value)==null?void 0:e.type)==="1"?(d(),_($,{key:1,shadow:"never",class:"mb-8",style:{width:"50%"}},{default:s(()=>[l("div",ce,[o(i,{class:"mr-8 avatar-purple",shape:"square",size:32},{default:s(()=>a[5]||(a[5]=[l("img",{src:j,style:{width:"58%"},alt:""},null,-1)])),_:1}),l("div",null,[l("div",null,p(t.$t("views.dataset.web")),1),o(m,{type:"info"},{default:s(()=>[b(p(t.$t("views.dataset.datasetForm.form.datasetType.webInfo")),1)]),_:1})])])]),_:1})):f("",!0)]}),_:1},8,["label"]),c.value.type==="1"?(d(),_(F,{key:0,label:t.$t("views.dataset.datasetForm.form.source_url.label"),prop:"source_url"},{default:s(()=>[o(A,{modelValue:n.value.source_url,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value.source_url=e),placeholder:t.$t("views.dataset.datasetForm.form.source_url.placeholder"),onBlur:a[1]||(a[1]=e=>n.value.source_url=n.value.source_url.trim())},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):f("",!0),c.value.type==="1"?(d(),_(F,{key:1,label:t.$t("views.dataset.datasetForm.form.selector.label")},{default:s(()=>[o(A,{modelValue:n.value.selector,"onUpdate:modelValue":a[2]||(a[2]=e=>n.value.selector=e),placeholder:t.$t("views.dataset.datasetForm.form.selector.placeholder"),onBlur:a[3]||(a[3]=e=>n.value.selector=n.value.selector.trim())},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):f("",!0)]),_:1},8,["rules","model"]),w.value.length>0?(d(),q("div",ue,[l("h4",_e,p(t.$t("views.dataset.relatedApplications")),1),o(E,{gutter:12},{default:s(()=>[(d(!0),q(ee,null,te(C.value.filter(e=>w.value.some(D=>D===(e==null?void 0:e.id))),(e,D)=>(d(),_(N,{span:12,key:D,class:"mb-16"},{default:s(()=>[o($,{shadow:"never"},{default:s(()=>[l("div",pe,[l("div",me,[ae(se)(e==null?void 0:e.icon)?(d(),_(i,{key:0,shape:"square",size:32,style:{background:"none"},class:"mr-12"},{default:s(()=>[l("img",{src:e==null?void 0:e.icon,alt:""},null,8,ve)]),_:2},1024)):e!=null&&e.name?(d(),_(i,{key:1,name:e==null?void 0:e.name,pinyinColor:"",shape:"square",size:32,class:"mr-12"},null,8,["name"])):f("",!0),b(" "+p(e.name),1)])])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):f("",!0),l("div",fe,[o(U,{onClick:R,type:"primary"},{default:s(()=>[b(p(t.$t("common.save")),1)]),_:1})])])),[[K,h.value]])]),_:1})])]),_:1},8,["header"])}}});const we=oe(ge,[["__scopeId","data-v-9c5a864f"]]);export{we as default};
