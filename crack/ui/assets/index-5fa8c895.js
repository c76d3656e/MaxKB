import{cr as E,dm as F,cs as t,cq as m,cv as i,cy as L,cG as R,cB as a,cA as s,cC as n,cK as p,cL as w,cI as T,dC as b,de as q}from"./index-a6cfd98b.js";const B={class:"mb-24"},Z={class:"mb-24"},M={class:"mb-24"},N={class:"flex-between w-full"},P={class:"operate-container mt-12"},D=E({__name:"index",setup(S){const h=F(),l=t({email:"",code:"",type:"reset_password"}),v=t(),$=t({email:[{required:!0,message:m("views.user.userForm.form.email.requiredMessage"),trigger:"blur"},{validator:(e,o,r)=>{!/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*\.[a-zA-Z0-9]{2,6}$/.test(o)&&o!=""?r(new Error(m("views.user.userForm.form.email.validatorEmail"))):r()},trigger:"blur"}],code:[{required:!0,message:m("views.login.verificationCode.placeholder")}]}),f=t(!1),d=t(!1),u=t(60),k=()=>{var e;(e=v.value)==null||e.validate().then(()=>b.checkCode(l.value,f)).then(()=>h.push({name:"reset_password",params:l.value}))},y=()=>{var e;(e=v.value)==null||e.validateField("email",o=>{o&&b.sendEmit(l.value.email,"reset_password",f).then(()=>{q(m("views.login.verificationCode.successMessage")),d.value=!0,C()})})},C=()=>{u.value<=0?(d.value=!1,u.value=60):setTimeout(()=>{u.value--,C()},1e3)};return(e,o)=>{const r=i("el-input"),g=i("el-form-item"),_=i("el-button"),V=i("el-form"),z=i("LoginContainer"),A=i("login-layout");return L(),R(A,null,{default:a(()=>[s(z,{subTitle:e.$t("views.system.theme.defaultSlogan")},{default:a(()=>[n("h2",B,p(e.$t("views.login.forgotPassword")),1),s(V,{class:"register-form",ref_key:"resetPasswordFormRef",ref:v,model:l.value,rules:$.value},{default:a(()=>[n("div",Z,[s(g,{prop:"email"},{default:a(()=>[s(r,{size:"large",class:"input-item",modelValue:l.value.email,"onUpdate:modelValue":o[0]||(o[0]=c=>l.value.email=c),placeholder:e.$t("views.user.userForm.form.email.placeholder")},null,8,["modelValue","placeholder"])]),_:1})]),n("div",M,[s(g,{prop:"code"},{default:a(()=>[n("div",N,[s(r,{size:"large",class:"code-input",modelValue:l.value.code,"onUpdate:modelValue":o[1]||(o[1]=c=>l.value.code=c),placeholder:e.$t("views.login.verificationCode.placeholder")},null,8,["modelValue","placeholder"]),s(_,{disabled:d.value,size:"large",class:"send-email-button ml-12",onClick:y,loading:f.value},{default:a(()=>[w(p(d.value?`${e.$t("views.login.verificationCode.resend")}（${u.value}s）`:e.$t("views.login.verificationCode.getVerificationCode")),1)]),_:1},8,["disabled","loading"])])]),_:1})])]),_:1},8,["model","rules"]),s(_,{size:"large",type:"primary",class:"w-full",onClick:k},{default:a(()=>[w(p(e.$t("views.login.buttons.checkCode")),1)]),_:1}),n("div",P,[s(_,{class:"register",onClick:o[2]||(o[2]=c=>T(h).push("/login")),link:"",type:"primary",icon:"ArrowLeft"},{default:a(()=>[w(p(e.$t("views.login.buttons.backLogin")),1)]),_:1})])]),_:1},8,["subTitle"])]),_:1})}}});export{D as default};
