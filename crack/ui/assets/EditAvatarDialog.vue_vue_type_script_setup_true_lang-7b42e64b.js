import{cr as N,cZ as F,dk as T,cs as c,da as j,cv as p,cy as g,cG as w,cB as a,cC as l,cA as i,cF as P,cL as A,cK as u,cM as O,dq as V,cR as x,cX as k,cq as v,d_ as G,de as y,dO as K}from"./index-a6cfd98b.js";const X={class:"mt-8"},Z={class:"flex mt-8"},H=["src"],J={class:"el-upload__tip info mt-16"},Q={class:"dialog-footer"},ee=N({__name:"EditAvatarDialog",emits:["refresh"],setup(W,{expose:C,emit:$}){const{application:U}=F(),z=T(),{params:{id:h}}=z,D=$,d=c(null),r=c(null),t=c(!1),m=c(!1),f=c(null),n=c("default");j(t,e=>{e||(d.value=null,r.value=null)});const L=e=>{n.value=V(e.icon)?"custom":"default",r.value=V(e.icon)?e.icon:null,f.value=x.cloneDeep(e),t.value=!0},R=e=>{if((e==null?void 0:e.size)/1024/1024<10)d.value=e,r.value=URL.createObjectURL(e.raw);else return k(v("views.applicationOverview.appInfo.EditAvatarDialog.fileSizeExceeded")),!1};function S(){if(n.value==="default")U.asyncPutApplication(h,{icon:G},m).then(e=>{D("refresh"),y(v("views.applicationOverview.appInfo.EditAvatarDialog.setSuccess")),t.value=!1});else if(n.value==="custom"&&d.value){let e=new FormData;e.append("file",d.value.raw),K.putAppIcon(h,e,m).then(o=>{D("refresh"),y(v("views.applicationOverview.appInfo.EditAvatarDialog.setSuccess")),t.value=!1})}else k(v("views.applicationOverview.appInfo.EditAvatarDialog.uploadImagePrompt"))}return C({open:L}),(e,o)=>{const E=p("AppAvatar"),I=p("el-radio"),_=p("el-button"),q=p("el-upload"),B=p("el-radio-group"),M=p("el-dialog");return g(),w(M,{title:e.$t("views.applicationOverview.appInfo.EditAvatarDialog.title"),modelValue:t.value,"onUpdate:modelValue":o[2]||(o[2]=s=>t.value=s),"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:a(()=>[l("span",Q,[i(_,{onClick:o[1]||(o[1]=P(s=>t.value=!1,["prevent"]))},{default:a(()=>[A(u(e.$t("common.cancel")),1)]),_:1}),i(_,{type:"primary",onClick:S,loading:m.value},{default:a(()=>[A(u(e.$t("common.save")),1)]),_:1},8,["loading"])])]),default:a(()=>[i(B,{modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=s=>n.value=s),class:"radio-block mb-16"},{default:a(()=>[l("div",null,[i(I,{value:"default"},{default:a(()=>{var s,b;return[l("p",null,u(e.$t("views.applicationOverview.appInfo.EditAvatarDialog.default")),1),(s=f.value)!=null&&s.name?(g(),w(E,{key:0,name:(b=f.value)==null?void 0:b.name,pinyinColor:"",class:"mt-8 mb-8",shape:"square",size:32},null,8,["name"])):O("",!0)]}),_:1})]),l("div",X,[i(I,{value:"custom"},{default:a(()=>[l("p",null,u(e.$t("views.applicationOverview.appInfo.EditAvatarDialog.customizeUpload")),1),l("div",Z,[r.value?(g(),w(E,{key:0,shape:"square",size:32,style:{background:"none"},class:"mr-16"},{default:a(()=>[l("img",{src:r.value,alt:""},null,8,H)]),_:1})):O("",!0),i(q,{ref:"uploadRef",action:"#","auto-upload":!1,"show-file-list":!1,accept:"image/jpeg, image/png, image/gif","on-change":R},{default:a(()=>[i(_,{icon:"Upload",disabled:n.value!=="custom"},{default:a(()=>[A(u(e.$t("views.applicationOverview.appInfo.EditAvatarDialog.upload")),1)]),_:1},8,["disabled"])]),_:1},512)]),l("div",J,u(e.$t("views.applicationOverview.appInfo.EditAvatarDialog.sizeTip")),1)]),_:1})])]),_:1},8,["modelValue"])]),_:1},8,["title","modelValue"])}}});export{ee as _};
