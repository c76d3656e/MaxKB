import{cr as j,cs as w,da as oe,cv as u,cy as r,cG as h,cB as l,cC as t,cA as o,cF as A,cL as v,cK as s,cM as B,cz as x,cD as Z,cE as Y,cR as de,dd as ce,ct as O,cY as re,cq as U,cI as Q,e9 as se,cP as J,cZ as ne,c_ as pe,cu as _e,cS as me,cU as ue,cw as ve,ea as G,dm as fe,dV as $e,eb as ge,e4 as be,cX as ee,ec as we,dk as he,de as te}from"./index-a6cfd98b.js";import{_ as ie}from"./ParagraphForm.vue_vue_type_script_setup_true_lang-be0b3f51.js";const ye={class:"bold title p-24",style:{"padding-bottom":"0"}},ke={class:"flex align-center"},Ce={class:"p-24",style:{"padding-top":"16px"}},Ve={key:1,class:"p-24"},Re={class:"dialog-footer"},Te=j({__name:"EditParagraphDialog",props:{isConnect:Boolean},emits:["updateContent"],setup(z,{expose:L,emit:S}){const R=S,k=w(!1),a=w({}),b=w(),c=w(),_=w(!1),g=w("");oe(k,i=>{i||(a.value={})});const C=i=>{a.value=de.cloneDeep(i),k.value=!0};function T(i,e){a.value.problem_list.splice(e,1)}function y(){var i,e,n;g.value.trim()&&((i=a.value)!=null&&i.problem_list.some(d=>d.content===g.value.trim())||(n=(e=a.value)==null?void 0:e.problem_list)==null||n.push({content:g.value.trim()}),g.value="",_.value=!1)}function E(){_.value=!0,ce(()=>{var i;(i=c.value)==null||i.focus()})}const $=async()=>{var i,e;await((i=b.value)==null?void 0:i.validate())&&(R("updateContent",{problem_list:a.value.problem_list,...(e=b.value)==null?void 0:e.form}),k.value=!1)};return L({open:C}),(i,e)=>{const n=u("el-col"),d=u("el-divider"),p=u("Plus"),f=u("el-icon"),D=u("el-button"),M=u("el-input"),V=u("auto-tooltip"),I=u("TagEllipsis"),X=u("el-scrollbar"),q=u("el-row"),H=u("el-dialog");return r(),h(H,{title:i.$t("views.paragraph.editParagraph"),modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=P=>k.value=P),width:"80%","destroy-on-close":"",class:"paragraph-dialog","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:l(()=>[t("span",Re,[o(D,{onClick:e[2]||(e[2]=A(P=>k.value=!1,["prevent"]))},{default:l(()=>[v(s(i.$t("common.cancel")),1)]),_:1}),o(D,{type:"primary",onClick:$},{default:l(()=>[v(s(i.$t("common.save")),1)]),_:1})])]),default:l(()=>[z.isConnect?(r(),h(q,{key:0},{default:l(()=>[o(n,{span:18,class:"p-24"},{default:l(()=>[o(ie,{ref_key:"paragraphFormRef",ref:b,data:a.value,isEdit:!0},null,8,["data"])]),_:1}),o(n,{span:6,class:"border-l",style:{width:"300px"}},{default:l(()=>[t("p",ye,[t("span",ke,[t("span",null,s(i.$t("views.paragraph.relatedProblem.title")),1),o(d,{direction:"vertical",class:"mr-4"}),o(D,{text:"",onClick:E},{default:l(()=>[o(f,null,{default:l(()=>[o(p)]),_:1})]),_:1})])]),o(X,{height:"500px"},{default:l(()=>[t("div",Ce,[_.value?(r(),h(M,{key:0,modelValue:g.value,"onUpdate:modelValue":e[0]||(e[0]=P=>g.value=P),placeholder:i.$t("views.paragraph.relatedProblem.placeholder"),onChange:y,onBlur:e[1]||(e[1]=P=>_.value=!1),ref_key:"inputRef",ref:c},null,8,["modelValue","placeholder"])):B("",!0),(r(!0),x(Z,null,Y(a.value.problem_list,(P,N)=>(r(),h(I,{key:N,onClose:K=>T(P,N),class:"question-tag",type:"info",effect:"plain",closable:""},{default:l(()=>[o(V,{content:P.content},{default:l(()=>[v(s(P.content),1)]),_:2},1032,["content"])]),_:2},1032,["onClose"]))),128))])]),_:1})]),_:1})]),_:1})):(r(),x("div",Ve,[o(ie,{ref_key:"paragraphFormRef",ref:b,data:a.value,isEdit:!0},null,8,["data"])]))]),_:1},8,["title","modelValue"])}}}),Le={class:"flex-between"},Se={class:"lighter mt-12"},De={class:"lighter mt-12"},Fe=j({__name:"ParagraphList",props:{modelValue:{},isConnect:{type:Boolean}},emits:["update:modelValue"],setup(z,{emit:L}){const S=w(30),R=w(1),k=w(0),a=w(),b=L,c=w(!1),_=($,i)=>{k.value=i,a.value.open($)},g=z,C=O(()=>g.modelValue.slice(0,S.value*(R.value-1)+S.value)),T=()=>{c.value=!0,R.value+=1,c.value=!1},y=$=>{const i=[...g.modelValue];i[k.value]=de.cloneDeep($),b("update:modelValue",i)},E=($,i)=>{re(`${U("views.paragraph.delete.confirmTitle")}${$.title||"-"} ?`,U("views.paragraph.delete.confirmMessage"),{confirmButtonText:U("common.delete"),confirmButtonClass:"danger"}).then(()=>{const e=[...g.modelValue];e.splice(i,1),b("update:modelValue",e)}).catch(()=>{})};return($,i)=>{const e=u("EditPen"),n=u("el-icon"),d=u("el-button"),p=u("Delete"),f=u("el-text"),D=u("el-card"),M=u("InfiniteScroll");return r(),x("div",null,[o(M,{size:C.value.length,total:$.modelValue.length,page_size:S.value,current_page:R.value,"onUpdate:current_page":i[0]||(i[0]=V=>R.value=V),onLoad:i[1]||(i[1]=V=>T()),loading:c.value},{default:l(()=>[(r(!0),x(Z,null,Y(C.value,(V,I)=>(r(),h(D,{key:I,shadow:"never",class:"card-never mb-16"},{default:l(()=>[t("div",Le,[t("span",null,s(V.title||"-"),1),t("div",null,[o(d,{link:"",onClick:X=>_(V,I)},{default:l(()=>[o(n,null,{default:l(()=>[o(e)]),_:1})]),_:2},1032,["onClick"]),o(d,{link:"",onClick:X=>E(V,I)},{default:l(()=>[o(n,null,{default:l(()=>[o(p)]),_:1})]),_:2},1032,["onClick"])])]),t("div",Se,s(V.content),1),t("div",De,[o(f,{type:"info"},{default:l(()=>[v(s(V.content.length)+" "+s($.$t("views.paragraph.character_count")),1)]),_:2},1024)])]),_:2},1024))),128))]),_:1},8,["size","total","page_size","current_page","loading"]),o(Te,{ref_key:"EditParagraphDialogRef",ref:a,onUpdateContent:y,isConnect:$.isConnect},null,8,["isConnect"])])}}}),Pe={class:"flex-center"},Ue=["src"],xe={class:"ml-4"},ze={class:"mb-16"},Ee={key:0,class:"paragraph-list"},Me=j({__name:"ParagraphPreview",props:{data:{type:Array,default:()=>[]},isConnect:Boolean},setup(z){const L=w(0);return(S,R)=>{const k=u("el-text"),a=u("el-scrollbar"),b=u("el-tab-pane"),c=u("el-tabs");return r(),h(c,{modelValue:L.value,"onUpdate:modelValue":R[0]||(R[0]=_=>L.value=_),class:"paragraph-tabs"},{default:l(()=>[(r(!0),x(Z,null,Y(z.data,(_,g)=>(r(),h(b,{key:g,label:_.name,name:g},{label:l(()=>[t("div",Pe,[t("img",{src:Q(se)(_&&(_==null?void 0:_.name)),alt:"",height:"16"},null,8,Ue),t("span",xe,s(_==null?void 0:_.name),1)])]),default:l(()=>[t("div",ze,[o(k,{type:"info"},{default:l(()=>[v(s(_.content.length)+" "+s(S.$t("views.paragraph.title")),1)]),_:2},1024)]),L.value==g?(r(),x("div",Ee,[o(a,null,{default:l(()=>[o(Fe,{modelValue:_.content,"onUpdate:modelValue":C=>_.content=C,isConnect:z.isConnect},null,8,["modelValue","onUpdate:modelValue","isConnect"])]),_:2},1024)])):B("",!0)]),_:2},1032,["label","name"]))),128))]),_:1},8,["modelValue"])}}});const Ae=J(Me,[["__scopeId","data-v-666a6383"]]),Ie={class:"set-rules"},Be={class:"title-decoration-1 mb-16"},Xe={class:"set-rules__right"},Ne={class:"mb-4"},Qe={class:"mb-4"},qe={class:"set-rules__form"},He={class:"form-item mb-16"},Oe={class:"title flex align-center mb-8"},Ze={style:{"margin-right":"4px"}},je={class:"form-item mb-16"},Ke={class:"title mb-8"},Ge={class:"form-item mb-16"},Ye={class:"title mb-8"},Je={style:{"margin-top":"4px"}},We={class:"text-right mt-8"},et={class:"title-decoration-1 mb-8"},tt=j({__name:"SetRules",setup(z,{expose:L}){const{dataset:S}=ne(),R=O(()=>S.documentsFiles),k=w([]),a=w("1"),b=w(!1),c=w([]),_=w(!1),g=w(!1),C=w(!0),T=pe({patterns:[],limit:500,with_filter:!0});function y(i){i&&C.value&&(c.value=c.value.map(e=>({...e,content:e.content.map(n=>({...n,problem_list:n.title.trim()?[{content:n.title.trim()}]:[]}))})),C.value=!1)}function E(){b.value=!0;let i=new FormData;R.value.forEach(e=>{e!=null&&e.raw&&i.append("file",e==null?void 0:e.raw)}),a.value==="2"&&Object.keys(T).forEach(e=>{e=="patterns"?T.patterns.forEach(n=>i.append("patterns",n)):i.append(e,T[e])}),G.postSplitDocument(i).then(e=>{const n=e.data;g.value&&n.map(d=>{d.content.map(p=>{p.problem_list=p.title.trim()?[{content:p.title.trim()}]:[]})}),c.value=n,b.value=!1}).catch(()=>{b.value=!1})}const $=()=>{G.listSplitPattern(_).then(i=>{k.value=i.data})};return oe(a,()=>{a.value==="2"&&$()}),_e(()=>{E()}),L({paragraphList:c,checkedConnect:g,loading:b}),(i,e)=>{const n=u("el-text"),d=u("el-radio"),p=u("el-card"),f=u("AppIcon"),D=u("el-tooltip"),M=u("el-option"),V=u("el-select"),I=u("el-slider"),X=u("el-switch"),q=u("el-radio-group"),H=u("el-scrollbar"),P=u("el-checkbox"),N=u("el-button"),K=u("el-col"),W=u("el-row"),m=me("loading");return r(),x("div",Ie,[o(W,null,{default:l(()=>[o(K,{span:10,class:"p-24"},{default:l(()=>[t("h4",Be,s(i.$t("views.document.setRules.title.setting")),1),t("div",Xe,[o(H,null,{default:l(()=>[t("div",{class:"left-height",onClick:e[5]||(e[5]=A(()=>{},["stop"]))},[o(q,{modelValue:a.value,"onUpdate:modelValue":e[4]||(e[4]=F=>a.value=F),class:"set-rules__radio"},{default:l(()=>[o(p,{shadow:"never",class:ue(["mb-16",a.value==="1"?"active":""])},{default:l(()=>[o(d,{value:"1",size:"large"},{default:l(()=>[t("p",Ne,s(i.$t("views.document.setRules.intelligent.label")),1),o(n,{type:"info"},{default:l(()=>[v(s(i.$t("views.document.setRules.intelligent.text")),1)]),_:1})]),_:1})]),_:1},8,["class"]),o(p,{shadow:"never",class:ue(["mb-16",a.value==="2"?"active":""])},{default:l(()=>[o(d,{value:"2",size:"large"},{default:l(()=>[t("p",Qe,s(i.$t("views.document.setRules.advanced.label")),1),o(n,{type:"info"},{default:l(()=>[v(s(i.$t("views.document.setRules.advanced.text")),1)]),_:1})]),_:1}),a.value==="2"?(r(),h(p,{key:0,shadow:"never",class:"card-never mt-16",style:{"margin-left":"30px"}},{default:l(()=>[t("div",qe,[t("div",He,[t("div",Oe,[t("span",Ze,s(i.$t("views.document.setRules.patterns.label")),1),o(D,{effect:"dark",content:i.$t("views.document.setRules.patterns.tooltip"),placement:"right"},{default:l(()=>[o(f,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])]),t("div",{onClick:e[1]||(e[1]=A(()=>{},["stop"]))},[o(V,{modelValue:T.patterns,"onUpdate:modelValue":e[0]||(e[0]=F=>T.patterns=F),multiple:"","allow-create":"","default-first-option":"",filterable:"",placeholder:i.$t("views.document.setRules.patterns.placeholder")},{default:l(()=>[(r(!0),x(Z,null,Y(k.value,(F,ae)=>(r(),h(M,{key:ae,label:F.key,value:F.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])])]),t("div",je,[t("div",Ke,s(i.$t("views.document.setRules.limit.label")),1),o(I,{modelValue:T.limit,"onUpdate:modelValue":e[2]||(e[2]=F=>T.limit=F),"show-input":"","show-input-controls":!1,min:50,max:1e5},null,8,["modelValue"])]),t("div",Ge,[t("div",Ye,s(i.$t("views.document.setRules.with_filter.label")),1),o(X,{size:"small",modelValue:T.with_filter,"onUpdate:modelValue":e[3]||(e[3]=F=>T.with_filter=F)},null,8,["modelValue"]),t("div",Je,[o(n,{type:"info"},{default:l(()=>[v(s(i.$t("views.document.setRules.with_filter.text")),1)]),_:1})])])])]),_:1})):B("",!0)]),_:1},8,["class"])]),_:1},8,["modelValue"])])]),_:1}),t("div",null,[o(P,{modelValue:g.value,"onUpdate:modelValue":e[6]||(e[6]=F=>g.value=F),onChange:y,style:{"white-space":"normal"}},{default:l(()=>[v(s(i.$t("views.document.setRules.checkedConnect.label")),1)]),_:1},8,["modelValue"])]),t("div",We,[o(N,{onClick:E},{default:l(()=>[v(s(i.$t("views.document.buttons.preview")),1)]),_:1})])])]),_:1}),o(K,{span:14,class:"p-24 border-l"},{default:l(()=>[ve((r(),x("div",null,[t("h4",et,s(i.$t("views.document.setRules.title.preview")),1),o(Ae,{data:c.value,"onUpdate:data":e[7]||(e[7]=F=>c.value=F),isConnect:g.value},null,8,["data","isConnect"])])),[[m,b.value]])]),_:1})]),_:1})])}}});const lt=J(tt,[["__scopeId","data-v-f8fa8793"]]),ot={class:"mt-8"},st={class:"bold"},nt={class:"bold"},at={class:"bold"},ut={class:"result-success"},it={class:"bolder"},dt={class:"flex-between"},ct={class:"flex"},rt=["src"],pt={class:"ml-8"},_t=j({__name:"ResultSuccess",props:{data:{type:Object,default:()=>{}}},setup(z){const L=z,S=fe(),R=O(()=>{var a;return(a=L.data)==null?void 0:a.document_list.reduce((b,c)=>b+=c.paragraph_count,0)}),k=O(()=>{var a;return((a=L.data)==null?void 0:a.document_list.reduce((b,c)=>b+=c.char_length,0))||0});return(a,b)=>{const c=u("el-text"),_=u("el-divider"),g=u("el-button"),C=u("el-result"),T=u("SuccessFilled"),y=u("el-icon"),E=u("CircleCloseFilled"),$=u("Loading"),i=u("el-card"),e=u("el-scrollbar");return r(),h(e,null,{default:l(()=>{var n;return[o(C,{icon:"success",title:`🎉 ${a.$t("views.dataset.ResultSuccess.title")} 🎉`},{"sub-title":l(()=>{var d;return[t("div",ot,[t("span",st,s(((d=z.data)==null?void 0:d.document_list.length)||0),1),o(c,{type:"info",class:"ml-4"},{default:l(()=>[v(s(a.$t("common.fileUpload.document")),1)]),_:1}),o(_,{direction:"vertical"}),t("span",nt,s(R.value||0),1),o(c,{type:"info",class:"ml-4"},{default:l(()=>[v(s(a.$t("views.dataset.ResultSuccess.paragraph")),1)]),_:1}),o(_,{direction:"vertical"}),t("span",at,s(Q($e)(k.value)||0),1),o(c,{type:"info",class:"ml-4"},{default:l(()=>[v(s(a.$t("common.character")),1)]),_:1})])]}),extra:l(()=>[o(g,{onClick:b[0]||(b[0]=d=>Q(S).push({path:"/dataset"}))},{default:l(()=>[v(s(a.$t("views.dataset.ResultSuccess.buttons.toDataset")),1)]),_:1}),o(g,{type:"primary",onClick:b[1]||(b[1]=d=>{var p;return Q(S).push({path:`/dataset/${(p=z.data)==null?void 0:p.id}/document`})})},{default:l(()=>[v(s(a.$t("views.dataset.ResultSuccess.buttons.toDocument")),1)]),_:1})]),_:1},8,["title"]),t("div",ut,[t("p",it,s(a.$t("views.dataset.ResultSuccess.documentList")),1),(r(!0),x(Z,null,Y((n=z.data)==null?void 0:n.document_list,(d,p)=>(r(),h(i,{shadow:"never",class:"file-List-card mt-8",key:p},{default:l(()=>[t("div",dt,[t("div",ct,[t("img",{src:Q(se)(d&&(d==null?void 0:d.name)),alt:"",width:"40"},null,8,rt),t("div",pt,[t("p",null,s(d&&(d==null?void 0:d.name)),1),o(c,{type:"info",size:"small"},{default:l(()=>[v(s(Q(ge)(d&&(d==null?void 0:d.char_length))),1)]),_:2},1024)])]),t("div",null,[o(c,{type:"info",class:"mr-16"},{default:l(()=>[v(s(d&&(d==null?void 0:d.paragraph_count))+" "+s(a.$t("views.dataset.ResultSuccess.paragraph_count")),1)]),_:2},1024),d.status==="1"?(r(),h(c,{key:0},{default:l(()=>[o(y,{class:"success"},{default:l(()=>[o(T)]),_:1})]),_:1})):d.status==="2"?(r(),h(c,{key:1},{default:l(()=>[o(y,{class:"danger"},{default:l(()=>[o(E)]),_:1})]),_:1})):d.status==="0"?(r(),h(c,{key:2},{default:l(()=>[o(y,{class:"is-loading primary"},{default:l(()=>[o($)]),_:1}),v(" "+s(a.$t("views.dataset.ResultSuccess.loading"))+"... ",1)]),_:1})):B("",!0)])])]),_:2},1024))),128))])]}),_:1})}}});const mt=J(_t,[["__scopeId","data-v-714bf56b"]]),le="/ui/assets/upload-icon-7e567789.svg",vt={class:"title-decoration-1 mb-8"},ft={class:"mt-16 mb-16"},gt={class:"update-info flex p-8-12 border-r-4 mb-16 w-full"},bt={class:"mt-4"},$t={class:"ml-16 lighter"},wt={class:"el-upload__text"},ht={class:"upload__decoration"},yt={class:"update-info flex p-8-12 border-r-4 mb-16 w-full"},kt={class:"mt-4"},Ct={class:"ml-16 lighter"},Vt={class:"el-upload__text"},Rt={class:"upload__decoration"},Tt={class:"update-info flex p-8-12 border-r-4 mb-16 w-full"},Lt={class:"mt-4"},St={class:"ml-16 lighter"},Dt={class:"el-upload__text"},Ft={class:"upload__decoration"},Pt={class:"flex-between"},Ut={class:"flex"},xt=["src"],zt={class:"ml-8"},Et=j({__name:"UploadComponent",setup(z,{expose:L}){const{dataset:S}=ne(),R=O(()=>S.documentsFiles),k=O(()=>S.documentsType),a=w({fileType:"txt",fileList:[]}),b=pe({fileList:[{required:!0,message:U("views.document.upload.requiredMessage"),trigger:"change"}]}),c=w();oe(a.value,e=>{S.saveDocumentsType(e.fileType),S.saveDocumentsFile(e.fileList)});function _(e){G.exportQATemplate(`${e}${U("views.document.upload.template")}.${e=="csv"?e:"xlsx"}`,e)}function g(e){G.exportTableTemplate(`${e}${U("views.document.upload.template")}.${e=="csv"?e:"xlsx"}`,e)}function C(){a.value.fileList=[]}function T(e){a.value.fileList.splice(e,1)}const y=(e,n)=>{if(!((e==null?void 0:e.size)/1024/1024<100))return ee(U("views.document.upload.errorMessage1")),n.splice(-1,1),!1;if(!we(e==null?void 0:e.name,a.value.fileType))return ee(U("views.document.upload.errorMessage2")),n.splice(-1,1),!1;if((e==null?void 0:e.size)===0)return ee(U("views.document.upload.errorMessage3")),n.splice(-1,1),!1},E=()=>{ee(U("views.document.upload.errorMessage4"))},$=e=>{let n=null;ce(()=>{document.querySelector(".el-upload__input")!=null&&(n=document.querySelector(".el-upload__input"),n.webkitdirectory=e)})};function i(){if(c.value)return c.value.validate(e=>e)}return _e(()=>{k.value&&(a.value.fileType=k.value),R.value&&(a.value.fileList=R.value)}),be(()=>{a.value={fileType:"txt",fileList:[]}}),L({validate:i,form:a}),(e,n)=>{var W;const d=u("el-radio-button"),p=u("el-radio-group"),f=u("AppIcon"),D=u("el-button"),M=u("el-upload"),V=u("el-form-item"),I=u("el-form"),X=u("el-text"),q=u("Delete"),H=u("el-icon"),P=u("el-card"),N=u("el-col"),K=u("el-row");return r(),x(Z,null,[t("h4",vt,s(e.$t("views.document.uploadDocument")),1),o(I,{ref_key:"FormRef",ref:c,model:a.value,rules:b,"label-position":"top","require-asterisk-position":"right"},{default:l(()=>[t("div",ft,[o(p,{modelValue:a.value.fileType,"onUpdate:modelValue":n[0]||(n[0]=m=>a.value.fileType=m),onChange:C,class:"app-radio-button-group"},{default:l(()=>[o(d,{value:"txt"},{default:l(()=>[v(s(e.$t("views.document.fileType.txt.label")),1)]),_:1}),o(d,{value:"table"},{default:l(()=>[v(s(e.$t("views.document.fileType.table.label")),1)]),_:1}),o(d,{value:"QA"},{default:l(()=>[v(s(e.$t("views.document.fileType.QA.label")),1)]),_:1})]),_:1},8,["modelValue"])]),a.value.fileType==="QA"?(r(),h(V,{key:0,prop:"fileList"},{default:l(()=>[t("div",gt,[t("div",bt,[o(f,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),t("div",$t,[t("p",null,[v(s(e.$t("views.document.fileType.QA.tip1"))+" ",1),o(D,{type:"primary",link:"",onClick:n[1]||(n[1]=m=>_("excel"))},{default:l(()=>[v(s(e.$t("views.document.upload.download"))+" Excel "+s(e.$t("views.document.upload.template")),1)]),_:1}),o(D,{type:"primary",link:"",onClick:n[2]||(n[2]=m=>_("csv"))},{default:l(()=>[v(s(e.$t("views.document.upload.download"))+" CSV "+s(e.$t("views.document.upload.template")),1)]),_:1})]),t("p",null,s(e.$t("views.document.fileType.QA.tip2")),1),t("p",null,s(e.$t("views.document.fileType.QA.tip3")),1)])]),o(M,{webkitdirectory:!1,class:"w-full mb-4",drag:"",multiple:"","file-list":a.value.fileList,"onUpdate:fileList":n[5]||(n[5]=m=>a.value.fileList=m),action:"#","auto-upload":!1,"show-file-list":!1,accept:".xlsx, .xls, .csv,.zip",limit:50,"on-exceed":E,"on-change":y,onClick:n[6]||(n[6]=A(m=>$(!1),["prevent"]))},{default:l(()=>[n[17]||(n[17]=t("img",{src:le,alt:""},null,-1)),t("div",wt,[t("p",null,[v(s(e.$t("views.document.upload.uploadMessage"))+" ",1),t("em",{class:"hover",onClick:n[3]||(n[3]=A(m=>$(!1),["prevent"]))},s(e.$t("views.document.upload.selectFile")),1),t("em",{class:"hove ml-4",onClick:n[4]||(n[4]=A(m=>$(!0),["prevent"]))},s(e.$t("views.document.upload.selectFiles")),1)]),t("div",ht,[t("p",null,s(e.$t("views.document.upload.formats"))+"XLS、XLSX、CSV、ZIP",1)])])]),_:1},8,["file-list"])]),_:1})):a.value.fileType==="table"?(r(),h(V,{key:1,prop:"fileList"},{default:l(()=>[t("div",yt,[t("div",kt,[o(f,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),t("div",Ct,[t("p",null,[v(s(e.$t("views.document.fileType.table.tip1"))+" ",1),o(D,{type:"primary",link:"",onClick:n[7]||(n[7]=m=>g("excel"))},{default:l(()=>[v(s(e.$t("views.document.upload.download"))+" Excel "+s(e.$t("views.document.upload.template")),1)]),_:1}),o(D,{type:"primary",link:"",onClick:n[8]||(n[8]=m=>g("csv"))},{default:l(()=>[v(s(e.$t("views.document.upload.download"))+" CSV "+s(e.$t("views.document.upload.template")),1)]),_:1})]),t("p",null,s(e.$t("views.document.fileType.table.tip2")),1),t("p",null,s(e.$t("views.document.fileType.table.tip3")),1),t("p",null,s(e.$t("views.document.fileType.table.tip4")),1)])]),o(M,{webkitdirectory:!1,class:"w-full mb-4",drag:"",multiple:"","file-list":a.value.fileList,"onUpdate:fileList":n[11]||(n[11]=m=>a.value.fileList=m),action:"#","auto-upload":!1,"show-file-list":!1,accept:".xlsx, .xls, .csv",limit:50,"on-exceed":E,"on-change":y,onClick:n[12]||(n[12]=A(m=>$(!1),["prevent"]))},{default:l(()=>[n[18]||(n[18]=t("img",{src:le,alt:""},null,-1)),t("div",Vt,[t("p",null,[v(s(e.$t("views.document.upload.uploadMessage"))+" ",1),t("em",{class:"hover",onClick:n[9]||(n[9]=A(m=>$(!1),["prevent"]))},s(e.$t("views.document.upload.selectFile")),1),t("em",{class:"hover ml-4",onClick:n[10]||(n[10]=A(m=>$(!0),["prevent"]))},s(e.$t("views.document.upload.selectFiles")),1)]),t("div",Rt,[t("p",null,s(e.$t("views.document.upload.formats"))+"XLS、XLSX、CSV",1)])])]),_:1},8,["file-list"])]),_:1})):(r(),h(V,{key:2,prop:"fileList"},{default:l(()=>[t("div",Tt,[t("div",Lt,[o(f,{iconName:"app-warning-colorful",style:{"font-size":"16px"}})]),t("div",St,[t("p",null,s(e.$t("views.document.fileType.txt.tip1")),1),t("p",null,s(e.$t("views.document.fileType.txt.tip2")),1)])]),o(M,{webkitdirectory:!1,class:"w-full",drag:"",multiple:"","file-list":a.value.fileList,"onUpdate:fileList":n[15]||(n[15]=m=>a.value.fileList=m),action:"#","auto-upload":!1,"show-file-list":!1,accept:".txt, .md, .log, .docx, .pdf, .html,.zip,.xlsx,.xls,.csv",limit:50,"on-exceed":E,"on-change":y,onClick:n[16]||(n[16]=A(m=>$(!1),["prevent"]))},{default:l(()=>[n[19]||(n[19]=t("img",{src:le,alt:""},null,-1)),t("div",Dt,[t("p",null,[v(s(e.$t("views.document.upload.uploadMessage"))+" ",1),t("em",{class:"hover",onClick:n[13]||(n[13]=A(m=>$(!1),["prevent"]))},s(e.$t("views.document.upload.selectFile")),1),t("em",{class:"hover ml-4",onClick:n[14]||(n[14]=A(m=>$(!0),["prevent"]))},s(e.$t("views.document.upload.selectFiles")),1)]),t("div",Ft,[t("p",null,s(e.$t("views.document.upload.formats"))+"TXT、Markdown、PDF、DOCX、HTML、XLS、XLSX、CSV、ZIP",1)])])]),_:1},8,["file-list"])]),_:1}))]),_:1},8,["model","rules"]),(W=a.value.fileList)!=null&&W.length?(r(),h(K,{key:0,gutter:8},{default:l(()=>[(r(!0),x(Z,null,Y(a.value.fileList,(m,F)=>(r(),h(N,{key:F,span:12,class:"mb-8"},{default:l(()=>[o(P,{shadow:"never",class:"file-List-card"},{default:l(()=>[t("div",Pt,[t("div",Ut,[t("img",{src:Q(se)(m&&(m==null?void 0:m.name)),alt:"",width:"40"},null,8,xt),t("div",zt,[t("p",null,s(m&&(m==null?void 0:m.name)),1),o(X,{type:"info",size:"small"},{default:l(()=>[v(s(Q(ge)(m&&(m==null?void 0:m.size))||"0K"),1)]),_:2},1024)])]),o(D,{text:"",onClick:ae=>T(F)},{default:l(()=>[o(H,null,{default:l(()=>[o(q)]),_:1})]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})):B("",!0)],64)}}});const Mt=J(Et,[["__scopeId","data-v-ee481425"]]),At={class:"create-dataset__main flex"},It={class:"create-dataset__component main-calc-height"},Bt={key:0,class:"upload-document p-24"},Xt={key:0,class:"create-dataset__footer text-right border-t"},Nt=j({__name:"UploadDocumentDataset",setup(z){const{dataset:L,document:S}=ne(),R=O(()=>L.documentsFiles),k=O(()=>L.documentsType),a=fe(),b=he(),{query:{id:c}}=b,_=w(),g=w(),C=w(!1),T=w(!1),y=w(0),E=w(null);async function $(){if(T.value=!0,await g.value.validate())if(k.value==="QA"){let p=new FormData;R.value.forEach(f=>{f!=null&&f.raw&&p.append("file",f==null?void 0:f.raw)}),c&&G.postQADocument(c,p,C).then(f=>{te(U("common.submitSuccess")),e(),a.push({path:`/dataset/${c}/document`})})}else if(k.value==="table"){let p=new FormData;R.value.forEach(f=>{f!=null&&f.raw&&p.append("file",f==null?void 0:f.raw)}),c&&G.postTableDocument(c,p,C).then(f=>{te(U("common.submitSuccess")),e(),a.push({path:`/dataset/${c}/document`})})}else y.value++>2&&(y.value=0);else T.value=!1}const i=()=>{y.value=0};function e(){L.saveDocumentsFile([]),L.saveDocumentsType("")}function n(){var f;C.value=!0;const p=[];(f=_.value)==null||f.paragraphList.map(D=>{var M;(M=_.value)!=null&&M.checkedConnect||D.content.map(V=>{delete V.problem_list}),p.push({name:D.name,paragraphs:D.content})}),c&&S.asyncPostDocument(c,p).then(()=>{te(U("common.submitSuccess")),e(),a.push({path:`/dataset/${c}/document`})}).catch(()=>{C.value=!1})}function d(){var p;((p=R.value)==null?void 0:p.length)>0?re(U("common.tip"),U("views.document.tip.saveMessage"),{confirmButtonText:U("common.confirm"),type:"warning"}).then(()=>{a.go(-1),e()}).catch(()=>{}):a.go(-1)}return be(()=>{e()}),(p,f)=>{const D=u("back-button"),M=u("el-scrollbar"),V=u("el-button"),I=u("LayoutContainer"),X=me("loading");return r(),h(I,{header:p.$t("views.document.uploadDocument"),class:"create-dataset"},{backButton:l(()=>[o(D,{onClick:d})]),default:l(()=>{var q,H,P,N;return[ve((r(),x("div",At,[t("div",It,[o(M,null,{default:l(()=>[y.value===0?(r(),x("div",Bt,[o(Mt,{ref_key:"UploadComponentRef",ref:g},null,512)])):y.value===1?(r(),h(lt,{key:1,ref_key:"SetRulesRef",ref:_},null,512)):y.value===2?(r(),h(mt,{key:2,data:E.value},null,8,["data"])):B("",!0)]),_:1})])])),[[X,C.value]]),y.value!==2?(r(),x("div",Xt,[o(V,{onClick:f[0]||(f[0]=K=>Q(a).go(-1)),disabled:((q=_.value)==null?void 0:q.loading)||C.value},{default:l(()=>[v(s(p.$t("common.cancel")),1)]),_:1},8,["disabled"]),y.value===1?(r(),h(V,{key:0,onClick:i,disabled:((H=_.value)==null?void 0:H.loading)||C.value},{default:l(()=>[v(s(p.$t("views.document.buttons.prev")),1)]),_:1},8,["disabled"])):B("",!0),y.value===0?(r(),h(V,{key:1,onClick:$,type:"primary",disabled:((P=_.value)==null?void 0:P.loading)||C.value},{default:l(()=>[v(s(k.value==="txt"?p.$t("views.document.buttons.next"):p.$t("views.document.buttons.import")),1)]),_:1},8,["disabled"])):B("",!0),y.value===1?(r(),h(V,{key:2,onClick:n,type:"primary",disabled:((N=_.value)==null?void 0:N.loading)||C.value},{default:l(()=>[v(s(p.$t("views.document.buttons.import")),1)]),_:1},8,["disabled"])):B("",!0)])):B("",!0)]}),_:1},8,["header"])}}});const Ht=J(Nt,[["__scopeId","data-v-8da16b66"]]);export{Ht as default};
