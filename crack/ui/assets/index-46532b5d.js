import{cr as re,dk as de,cs as u,ct as A,cu as ue,cv as i,cS as pe,cy as d,cz as v,cA as t,cB as a,cC as s,cL as r,cK as n,cw as F,dR as _e,cM as w,cG as k,cI as me,cD as ve,cE as fe,cU as $,dA as he,cx as j,d$ as ge,e0 as ye,cR as G,cq as be,e1 as we,e2 as O,cO as ke,cP as $e}from"./index-a6cfd98b.js";import{_ as Ce}from"./ParagraphDialog.vue_vue_type_script_setup_true_lang-fc9285e5.js";import"./ParagraphForm.vue_vue_type_script_setup_true_lang-be0b3f51.js";const Ve="/ui/assets/hit-test-empty-4afe2647.png",xe={class:"hit-test"},De={class:"hit-test__main p-16"},Te={key:0,class:"question-title clearfix"},Se={class:"avatar"},Ae={class:"content"},Fe={class:"text break-all"},Re={class:"hit-test-height"},Ie={class:"active-button primary"},ze={class:"footer-content flex-between"},Be={key:0},Me={key:0},Ne={key:1,class:"ml-4"},qe={class:"hit-test__operate p-24 pt-0"},He={class:"mb-16"},Le={class:"title mb-8"},Pe={class:"mb-4"},Ue={class:"mb-4"},Ke={class:"mb-4"},Ee={class:"mb-16"},je={class:"title mb-8"},Ge={class:"mb-16"},Oe={class:"title mb-8"},Je={class:"text-right"},Qe={class:"operate-textarea flex"},We={class:"operate"},Xe={src:ge,alt:""},Ye={src:ye,alt:""},Ze=re({__name:"index",setup(et){const J=de(),{meta:{activeMenu:R},params:{id:I}}=J,z=u(),_=u(!1),f=u([]),B=u(""),p=u(""),C=u({similarity:.6,top_number:5,search_mode:"embedding"}),V=u(!0),c=u({}),h=u(!1),g=u(""),y=A(()=>!p.value),Q=A(()=>R.includes("application")),W=A(()=>R.includes("dataset"));function X(e){e==="keywords"?c.value.similarity=0:c.value.similarity=.6}function M(e){e==="open"?(h.value=!0,c.value=G.cloneDeep(C.value)):e==="close"&&(h.value=!1,C.value=G.cloneDeep(c.value))}function Y(e){B.value=be("views.paragraph.paragraphDetail"),z.value.open(e)}function N(e){e.ctrlKey?p.value+=`
`:(e.preventDefault(),!y.value&&!_.value&&q())}function q(){const e={query_text:p.value,...C.value};W.value?we.getDatasetHitTest(I,e,_).then(o=>{f.value=o.data&&O(o.data,"comprehensive_score",!0),g.value=p.value,p.value="",V.value=!1}):Q.value&&ke.getApplicationHitTest(I,e,_).then(o=>{f.value=o.data&&O(o.data,"comprehensive_score",!0),g.value=p.value,p.value="",V.value=!1})}function Z(e){if(e){const o=f.value.filter(m=>m.id===e.id)[0];o.content=e.content,o.title=e.title}else f.value=[],q()}return ue(()=>{}),(e,o)=>{const m=i("el-text"),H=i("AppAvatar"),L=i("el-empty"),ee=i("Document"),te=i("el-icon"),P=i("AppIcon"),ae=i("CardBox"),x=i("el-col"),U=i("el-row"),oe=i("el-scrollbar"),le=i("LayoutContainer"),b=i("el-button"),D=i("el-radio"),T=i("el-card"),se=i("el-radio-group"),K=i("el-input-number"),ne=i("el-popover"),ie=i("el-input"),ce=pe("loading");return d(),v("div",xe,[t(le,null,{header:a(()=>[s("h4",null,[r(n(e.$t("views.application.hitTest.title"))+" ",1),t(m,{type:"info",class:"ml-4"},{default:a(()=>[r(n(e.$t("views.application.hitTest.text")),1)]),_:1})])]),default:a(()=>[F((d(),v("div",De,[g.value?(d(),v("div",Te,[s("div",Se,[t(H,null,{default:a(()=>o[8]||(o[8]=[s("img",{src:_e,style:{width:"54%"},alt:""},null,-1)])),_:1})]),s("div",Ae,[s("h4",Fe,n(g.value),1)])])):w("",!0),t(oe,null,{default:a(()=>[s("div",Re,[V.value?(d(),k(L,{key:0,image:me(Ve),description:e.$t("views.application.hitTest.emptyMessage1")},null,8,["image","description"])):f.value.length==0?(d(),k(L,{key:1,description:e.$t("views.application.hitTest.emptyMessage2")},null,8,["description"])):(d(),k(U,{key:2},{default:a(()=>[(d(!0),v(ve,null,fe(f.value,(l,E)=>(d(),k(x,{xs:24,sm:12,md:12,lg:8,xl:6,key:E,class:"p-8"},{default:a(()=>[t(ae,{shadow:"hover",title:l.title||"-",description:l.content,class:$(["document-card layout-bg layout-bg cursor",l.is_active?"":"disabled"]),showIcon:!1,onClick:S=>Y(l)},{icon:a(()=>[t(H,{class:"mr-12 avatar-light",size:22},{default:a(()=>[r(n(E+1+""),1)]),_:2},1024)]),footer:a(()=>[s("div",ze,[t(m,null,{default:a(()=>[t(te,null,{default:a(()=>[t(ee)]),_:1}),r(" "+n(l==null?void 0:l.document_name),1)]),_:2},1024),l.trample_num||l.star_num?(d(),v("div",Be,[l.star_num?(d(),v("span",Me,[t(P,{iconName:"app-like-color"}),r(" "+n(l.star_num),1)])):w("",!0),l.trample_num?(d(),v("span",Ne,[t(P,{iconName:"app-oppose-color"}),r(" "+n(l.trample_num),1)])):w("",!0)])):w("",!0)])]),default:a(()=>{var S;return[s("div",Ie,n((S=l.similarity)==null?void 0:S.toFixed(3)),1)]}),_:2},1032,["title","description","class","onClick"])]),_:2},1024))),128))]),_:1}))])]),_:1})])),[[ce,_.value]]),t(Ce,{ref_key:"ParagraphDialogRef",ref:z,title:B.value,onRefresh:Z},null,8,["title"])]),_:1}),s("div",qe,[t(ne,{visible:h.value,placement:"right-end",width:500,trigger:"click"},{reference:a(()=>[t(b,{icon:"Setting",class:"mb-8",onClick:o[0]||(o[0]=l=>M("open"))},{default:a(()=>[r(n(e.$t("common.paramSetting")),1)]),_:1})]),default:a(()=>[s("div",He,[s("div",Le,n(e.$t("views.application.applicationForm.dialog.selectSearchMode")),1),t(se,{modelValue:c.value.search_mode,"onUpdate:modelValue":o[1]||(o[1]=l=>c.value.search_mode=l),class:"card__radio",onChange:X},{default:a(()=>[t(T,{shadow:"never",class:$(["mb-16",c.value.search_mode==="embedding"?"active":""])},{default:a(()=>[t(D,{value:"embedding",size:"large"},{default:a(()=>[s("p",Pe,n(e.$t("views.application.applicationForm.dialog.vectorSearch")),1),t(m,{type:"info"},{default:a(()=>[r(n(e.$t("views.application.applicationForm.dialog.vectorSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),t(T,{shadow:"never",class:$(["mb-16",c.value.search_mode==="keywords"?"active":""])},{default:a(()=>[t(D,{value:"keywords",size:"large"},{default:a(()=>[s("p",Ue,n(e.$t("views.application.applicationForm.dialog.fullTextSearch")),1),t(m,{type:"info"},{default:a(()=>[r(n(e.$t("views.application.applicationForm.dialog.fullTextSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),t(T,{shadow:"never",class:$(["mb-16",c.value.search_mode==="blend"?"active":""])},{default:a(()=>[t(D,{value:"blend",size:"large"},{default:a(()=>[s("p",Ke,n(e.$t("views.application.applicationForm.dialog.hybridSearch")),1),t(m,{type:"info"},{default:a(()=>[r(n(e.$t("views.application.applicationForm.dialog.hybridSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1},8,["modelValue"])]),t(U,{gutter:20},{default:a(()=>[t(x,{span:12},{default:a(()=>[s("div",Ee,[s("div",je,n(e.$t("views.application.applicationForm.dialog.similarityThreshold")),1),t(K,{modelValue:c.value.similarity,"onUpdate:modelValue":o[2]||(o[2]=l=>c.value.similarity=l),min:0,max:c.value.search_mode==="blend"?2:1,precision:3,step:.1,"value-on-clear":0,"controls-position":"right",class:"w-full"},null,8,["modelValue","max"])])]),_:1}),t(x,{span:12},{default:a(()=>[s("div",Ge,[s("div",Oe,n(e.$t("views.application.applicationForm.dialog.topReferences")),1),t(K,{modelValue:c.value.top_number,"onUpdate:modelValue":o[3]||(o[3]=l=>c.value.top_number=l),min:1,max:100,"controls-position":"right",class:"w-full"},null,8,["modelValue"])])]),_:1})]),_:1}),s("div",Je,[t(b,{onClick:o[4]||(o[4]=l=>h.value=!1)},{default:a(()=>[r(n(e.$t("common.cancel")),1)]),_:1}),t(b,{type:"primary",onClick:o[5]||(o[5]=l=>M("close"))},{default:a(()=>[r(n(e.$t("common.confirm")),1)]),_:1})])]),_:1},8,["visible"]),s("div",Qe,[t(ie,{ref:"quickInputRef",modelValue:p.value,"onUpdate:modelValue":o[6]||(o[6]=l=>p.value=l),type:"textarea",placeholder:e.$t("common.inputPlaceholder"),autosize:{minRows:1,maxRows:8},onKeydown:o[7]||(o[7]=he(l=>N(l),["enter"]))},null,8,["modelValue","placeholder"]),s("div",We,[t(b,{text:"",class:"sent-button",disabled:y.value||_.value,onClick:N},{default:a(()=>[F(s("img",Xe,null,512),[[j,y.value||_.value]]),F(s("img",Ye,null,512),[[j,!y.value&&!_.value]])]),_:1},8,["disabled"])])])])])}}});const lt=$e(Ze,[["__scopeId","data-v-48005a53"]]);export{lt as default};
