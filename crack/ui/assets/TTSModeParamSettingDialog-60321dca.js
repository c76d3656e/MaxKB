import{cr as j,cs as p,cv as s,cy as F,cG as P,cB as a,cC as d,cA as l,cF as E,cL as w,cK as u,dF as J,cO as W,dG as Y,cP as Z,cq as N,c_ as oe,da as K,cU as O,cM as I,cN as ne,ct as se,cS as ie,cw as re,cz as ee,cD as ae,cE as de,cQ as ue,cX as pe}from"./index-a6cfd98b.js";const ce={class:"dialog-footer p-16"},me=j({__name:"AIModeParamSettingDialog",emits:["refresh"],setup(L,{expose:T,emit:R}){const y=p([]),q=R,g=p(),i=p({}),v=p(!1),o=p(!1),f=(m,b)=>b?W.getModelParamsForm(b,m,o):Y.getModelParamsForm(m,o),M=(m,b,D)=>{i.value={},f(m,b).then(t=>{var e;y.value=t.data,(e=g.value)==null||e.render(y.value,D)}),v.value=!0},$=(m,b)=>{f(m,b).then(n=>{y.value=n.data;const t=n.data.map(e=>e.show_default_value===!1?{[e.field]:void 0}:{[e.field]:e.default_value}).reduce((e,r)=>({...e,...r}),{});q("refresh",t)})},z=async()=>{var m;(m=g.value)==null||m.validate().then(()=>{q("refresh",i.value),v.value=!1})};return T({open:M,reset_default:$}),(m,b)=>{const D=s("el-button"),n=s("el-dialog");return F(),P(n,{"align-center":"",title:m.$t("common.paramSetting"),class:"aiMode-param-dialog",modelValue:v.value,"onUpdate:modelValue":b[2]||(b[2]=t=>v.value=t),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:a(()=>[d("span",ce,[l(D,{onClick:b[1]||(b[1]=E(t=>v.value=!1,["prevent"]))},{default:a(()=>[w(u(m.$t("common.cancel")),1)]),_:1}),l(D,{type:"primary",onClick:z,loading:o.value},{default:a(()=>[w(u(m.$t("common.confirm")),1)]),_:1},8,["loading"])])]),default:a(()=>[l(J,{modelValue:i.value,"onUpdate:modelValue":b[0]||(b[0]=t=>i.value=t),model:i.value,"label-position":"top","require-asterisk-position":"right",render_data:y.value,ref_key:"dynamicsFormRef",ref:g},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"])}}});const xe=Z(me,[["__scopeId","data-v-ff770558"]]),_e={class:"dialog-max-height"},fe={class:"p-16"},ve={class:"mb-4"},ge={class:"mb-4"},be={class:"mb-4"},he={class:"flex align-center"},we={class:"mr-4"},ye={class:"flex align-center"},Ve={class:"mr-4"},$e={class:"dialog-footer p-16"},Ie=j({__name:"ParamSettingDialog",emits:["refresh"],setup(L,{expose:T,emit:R}){const y=R,q=p(),g=p(),i={ai_questioning:"{question}",designated_answer:N("views.application.applicationForm.dialog.designated_answer")},v=N("views.application.applicationForm.dialog.defaultPrompt1",{question:"{question}"})+"<data></data>"+N("views.application.applicationForm.dialog.defaultPrompt2"),o=p({dataset_setting:{search_mode:"embedding",top_n:3,similarity:.6,max_paragraph_char_number:5e3,no_references_setting:{status:"ai_questioning",value:"{question}"}},problem_optimization:!1,problem_optimization_prompt:v}),f=p({ai_questioning:i.ai_questioning,designated_answer:i.designated_answer}),M=oe({ai_questioning:[{required:!0,message:N("views.application.applicationForm.form.aiModel.placeholder"),trigger:"blur"}],designated_answer:[{required:!0,message:N("views.application.applicationForm.form.prompt.requiredMessage"),trigger:"blur"}]}),$=p(!1),z=p(!1),m=p(!1);K($,t=>{var e;t||(o.value={dataset_setting:{search_mode:"embedding",top_n:3,similarity:.6,max_paragraph_char_number:5e3,no_references_setting:{status:"ai_questioning",value:"{question}"}},problem_optimization:!1,problem_optimization_prompt:""},f.value={ai_questioning:i.ai_questioning,designated_answer:i.designated_answer},(e=g.value)==null||e.clearValidate())});const b=(t,e)=>{m.value=ne(e),o.value={dataset_setting:{...t.dataset_setting},problem_optimization:t.problem_optimization,problem_optimization_prompt:t.problem_optimization_prompt},m.value||(f.value[o.value.dataset_setting.no_references_setting.status]=o.value.dataset_setting.no_references_setting.value),$.value=!0},D=async t=>{if(m.value)delete o.value.no_references_setting,y("refresh",o.value),$.value=!1;else{if(!t)return;await t.validate((e,r)=>{e&&(o.value.dataset_setting.no_references_setting.value=f.value[o.value.dataset_setting.no_references_setting.status],y("refresh",o.value),$.value=!1)})}};function n(t){t==="keywords"?o.value.dataset_setting.similarity=0:o.value.dataset_setting.similarity=.6}return T({open:b}),(t,e)=>{const r=s("el-text"),_=s("el-radio"),V=s("el-card"),k=s("el-radio-group"),c=s("el-form-item"),A=s("AppIcon"),C=s("el-tooltip"),U=s("el-input-number"),H=s("el-col"),G=s("el-row"),Q=s("el-slider"),S=s("el-input"),x=s("el-form"),B=s("el-switch"),te=s("el-scrollbar"),X=s("el-button"),le=s("el-dialog");return F(),P(le,{"align-center":"",title:t.$t("common.paramSetting"),class:"param-dialog",modelValue:$.value,"onUpdate:modelValue":e[11]||(e[11]=h=>$.value=h),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:a(()=>[d("span",$e,[l(X,{onClick:e[9]||(e[9]=E(h=>$.value=!1,["prevent"]))},{default:a(()=>[w(u(t.$t("common.cancel")),1)]),_:1}),l(X,{type:"primary",onClick:e[10]||(e[10]=h=>D(g.value)),loading:z.value},{default:a(()=>[w(u(t.$t("common.save")),1)]),_:1},8,["loading"])])]),default:a(()=>[d("div",_e,[l(te,null,{default:a(()=>[d("div",fe,[l(x,{"label-position":"top",ref_key:"paramFormRef",ref:q,model:o.value},{default:a(()=>[l(c,{label:t.$t("views.application.applicationForm.dialog.selectSearchMode")},{default:a(()=>[l(k,{modelValue:o.value.dataset_setting.search_mode,"onUpdate:modelValue":e[0]||(e[0]=h=>o.value.dataset_setting.search_mode=h),class:"card__radio",onChange:n},{default:a(()=>[l(V,{shadow:"never",class:O(["mb-16",o.value.search_mode==="embedding"?"active":""])},{default:a(()=>[l(_,{value:"embedding",size:"large"},{default:a(()=>[d("p",ve,u(t.$t("views.application.applicationForm.dialog.vectorSearch")),1),l(r,{type:"info"},{default:a(()=>[w(u(t.$t("views.application.applicationForm.dialog.vectorSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),l(V,{shadow:"never",class:O(["mb-16",o.value.dataset_setting.search_mode==="keywords"?"active":""])},{default:a(()=>[l(_,{value:"keywords",size:"large"},{default:a(()=>[d("p",ge,u(t.$t("views.application.applicationForm.dialog.fullTextSearch")),1),l(r,{type:"info"},{default:a(()=>[w(u(t.$t("views.application.applicationForm.dialog.fullTextSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"]),l(V,{shadow:"never",class:O(o.value.dataset_setting.search_mode==="blend"?"active":"")},{default:a(()=>[l(_,{value:"blend",size:"large"},{default:a(()=>[d("p",be,u(t.$t("views.application.applicationForm.dialog.hybridSearch")),1),l(r,{type:"info"},{default:a(()=>[w(u(t.$t("views.application.applicationForm.dialog.hybridSearchTooltip")),1)]),_:1})]),_:1})]),_:1},8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(G,{gutter:20},{default:a(()=>[l(H,{span:12},{default:a(()=>[l(c,null,{label:a(()=>[d("div",he,[d("span",we,u(t.$t("views.application.applicationForm.dialog.similarityThreshold")),1),l(C,{effect:"dark",content:t.$t("views.application.applicationForm.dialog.similarityTooltip"),placement:"right"},{default:a(()=>[l(A,{iconName:"app-warning",class:"app-warning-icon"})]),_:1},8,["content"])])]),default:a(()=>[l(U,{modelValue:o.value.dataset_setting.similarity,"onUpdate:modelValue":e[1]||(e[1]=h=>o.value.dataset_setting.similarity=h),min:0,max:o.value.search_mode==="blend"?2:1,precision:3,step:.1,"value-on-clear":0,"controls-position":"right",class:"w-full"},null,8,["modelValue","max"])]),_:1})]),_:1}),l(H,{span:12},{default:a(()=>[l(c,{label:t.$t("views.application.applicationForm.dialog.topReferences")},{default:a(()=>[l(U,{modelValue:o.value.dataset_setting.top_n,"onUpdate:modelValue":e[2]||(e[2]=h=>o.value.dataset_setting.top_n=h),min:1,max:100,"value-on-clear":1,"controls-position":"right",class:"w-full"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})]),_:1}),l(c,{label:t.$t("views.application.applicationForm.dialog.maxCharacters")},{default:a(()=>[l(Q,{modelValue:o.value.dataset_setting.max_paragraph_char_number,"onUpdate:modelValue":e[3]||(e[3]=h=>o.value.dataset_setting.max_paragraph_char_number=h),"show-input":"","show-input-controls":!1,min:500,max:1e5,class:"custom-slider"},null,8,["modelValue"])]),_:1},8,["label"]),m.value?I("",!0):(F(),P(c,{key:0,label:t.$t("views.application.applicationForm.dialog.noReferencesAction")},{default:a(()=>[l(x,{"label-position":"top",ref_key:"noReferencesformRef",ref:g,model:f.value,rules:M,class:"w-full","hide-required-asterisk":!0},{default:a(()=>[l(k,{modelValue:o.value.dataset_setting.no_references_setting.status,"onUpdate:modelValue":e[5]||(e[5]=h=>o.value.dataset_setting.no_references_setting.status=h),class:"radio-block"},{default:a(()=>[d("div",null,[l(_,{value:"ai_questioning"},{default:a(()=>[d("p",null,u(t.$t("views.application.applicationForm.dialog.continueQuestioning")),1)]),_:1})]),d("div",null,[l(_,{value:"designated_answer"},{default:a(()=>[d("p",null,u(t.$t("views.application.applicationForm.dialog.provideAnswer")),1),o.value.dataset_setting.no_references_setting.status==="designated_answer"?(F(),P(c,{key:0,prop:"designated_answer"},{default:a(()=>[l(S,{modelValue:f.value.designated_answer,"onUpdate:modelValue":e[4]||(e[4]=h=>f.value.designated_answer=h),rows:2,type:"textarea",maxlength:"2048",placeholder:i.designated_answer},null,8,["modelValue","placeholder"])]),_:1})):I("",!0)]),_:1})])]),_:1},8,["modelValue"])]),_:1},8,["model","rules"])]),_:1},8,["label"])),m.value?I("",!0):(F(),P(c,{key:1,onClick:e[7]||(e[7]=E(()=>{},["prevent"]))},{label:a(()=>[d("div",ye,[d("span",Ve,u(t.$t("views.application.applicationForm.form.problemOptimization.label")),1)])]),default:a(()=>[l(B,{size:"small",modelValue:o.value.problem_optimization,"onUpdate:modelValue":e[6]||(e[6]=h=>o.value.problem_optimization=h)},null,8,["modelValue"])]),_:1})),o.value.problem_optimization?(F(),P(c,{key:2,label:t.$t("views.application.applicationForm.form.prompt.label")},{default:a(()=>[l(S,{modelValue:o.value.problem_optimization_prompt,"onUpdate:modelValue":e[8]||(e[8]=h=>o.value.problem_optimization_prompt=h),rows:6,type:"textarea",maxlength:"2048",placeholder:v},null,8,["modelValue"])]),_:1},8,["label"])):I("",!0)]),_:1},8,["model"])])]),_:1})])]),_:1},8,["title","modelValue"])}}});const ke={class:"flex-between mb-8"},Fe=["id"],Ce={class:"flex align-center mr-8"},De={class:"flex-between"},Se={class:"max-height"},Pe=["title"],qe={class:"flex-between"},Me={class:"flex"},Le=j({__name:"AddDatasetDialog",props:{data:{type:Array,default:()=>[]},loading:Boolean},emits:["addData","refresh"],setup(L,{expose:T,emit:R}){const y=L,q=R,g=p(!1),i=p([]),v=p(""),o=p(""),f=p([]),M=se(()=>v.value?f.value.filter(n=>n.embedding_mode_id===v.value):f.value);K(g,n=>{n||(i.value=[],v.value="",o.value="")}),K(o,n=>{n?f.value=y.data.filter(t=>t.name.includes(n)):f.value=y.data});function $(){i.value.length>0?v.value=y.data.filter(n=>n.id===i.value[0])[0].embedding_mode_id:i.value.length===0&&(v.value="")}function z(){i.value=[],v.value=""}const m=n=>{f.value=y.data,i.value=n,i.value.length>0&&(v.value=y.data.filter(t=>t.id===i.value[0])[0].embedding_mode_id),g.value=!0},b=()=>{q("addData",i.value),g.value=!1},D=()=>{q("refresh")};return T({open:m}),(n,t)=>{const e=s("Refresh"),r=s("el-icon"),_=s("el-button"),V=s("el-divider"),k=s("el-text"),c=s("el-input"),A=s("CardCheckbox"),C=s("el-col"),U=s("el-row"),H=s("el-scrollbar"),G=s("el-dialog"),Q=ie("loading");return F(),P(G,{title:n.$t("views.application.applicationForm.dialog.addDataset"),modelValue:g.value,"onUpdate:modelValue":t[3]||(t[3]=S=>g.value=S),width:"600","append-to-body":"",class:"addDataset-dialog","align-center":"","close-on-click-modal":!1,"close-on-press-escape":!1},{header:a(({titleId:S,titleClass:x})=>[d("div",ke,[d("h4",{id:S,class:O(x)},u(n.$t("views.application.applicationForm.dialog.addDataset")),11,Fe),d("div",Ce,[l(_,{link:"",class:"ml-16",onClick:D},{default:a(()=>[l(r,{class:"mr-4"},{default:a(()=>[l(e)]),_:1}),w(u(n.$t("common.refresh")),1)]),_:1}),l(V,{direction:"vertical"})])]),d("div",De,[l(k,{type:"info",class:"color-secondary"},{default:a(()=>[w(u(n.$t("views.application.applicationForm.dialog.addDatasetPlaceholder")),1)]),_:1}),l(c,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=B=>o.value=B),placeholder:n.$t("common.search"),"prefix-icon":"Search",class:"w-240",clearable:""},null,8,["modelValue","placeholder"])])]),footer:a(()=>[d("div",qe,[d("div",Me,[i.value.length>0?(F(),P(k,{key:0,type:"info",class:"color-secondary mr-8"},{default:a(()=>[w(u(n.$t("views.application.applicationForm.dialog.selected"))+" "+u(i.value.length)+" "+u(n.$t("views.application.applicationForm.dialog.countDataset")),1)]),_:1})):I("",!0),i.value.length>0?(F(),P(_,{key:1,link:"",type:"primary",onClick:z},{default:a(()=>[w(u(n.$t("common.clear")),1)]),_:1})):I("",!0)]),d("span",null,[l(_,{onClick:t[2]||(t[2]=E(S=>g.value=!1,["prevent"]))},{default:a(()=>[w(u(n.$t("common.cancel")),1)]),_:1}),l(_,{type:"primary",onClick:b},{default:a(()=>[w(u(n.$t("common.confirm")),1)]),_:1})])])]),default:a(()=>[l(H,null,{default:a(()=>[d("div",Se,[re((F(),P(U,{gutter:12},{default:a(()=>[(F(!0),ee(ae,null,de(M.value,(S,x)=>(F(),P(C,{span:12,key:x,class:"mb-16"},{default:a(()=>[l(A,{"value-field":"id",data:S,modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=B=>i.value=B),onChange:$},{default:a(()=>[d("span",{class:"ellipsis cursor",title:S.name},u(S.name),9,Pe)]),_:2},1032,["data","modelValue"])]),_:2},1024))),128))]),_:1})),[[Q,L.loading]])])]),_:1})]),_:1},8,["title","modelValue"])}}});const ze={class:"flex-between"},Ae={class:"p-16"},Te={class:"dialog-footer p-16"},Re=j({__name:"TTSModeParamSettingDialog",emits:["refresh"],setup(L,{expose:T,emit:R}){const{params:{id:y}}=ue.config.globalProperties.$route,q=p(""),g=p([]),i=R,v=p(),o=p({}),f=p(!1),M=p(!1),$=p(!1),z=(e,r)=>r?W.getModelParamsForm(r,e,M):Y.getModelParamsForm(e,M),m=(e,r,_)=>{o.value={},q.value=e,z(e,r).then(k=>{var A;g.value=k.data;const c=k.data.map(C=>({[C.field]:C.show_default_value!==!1?C.default_value:void 0})).reduce((C,U)=>({...C,...U}),{});_&&Object.keys(_).forEach(C=>{C in c||delete _[C]}),_={...c,..._},(A=v.value)==null||A.render(g.value,_)}),f.value=!0},b=(e,r)=>{z(e,r).then(V=>{g.value=V.data;const k=V.data.map(c=>({[c.field]:c.show_default_value!==!1?c.default_value:void 0})).reduce((c,A)=>({...c,...A}),{});i("refresh",k)})},D=async()=>{var e;(e=v.value)==null||e.validate().then(()=>{i("refresh",o.value),f.value=!1})},n=p(null),t=()=>{const e={...o.value,tts_model_id:q.value};W.playDemoText(y,e,$).then(async r=>{if(r.type==="application/json"){const k=await r.text();pe(k);return}const _=new Blob([r],{type:"audio/mp3"}),V=URL.createObjectURL(_);n.value instanceof HTMLAudioElement?(n.value.src=V,n.value.play()):console.error("audioPlayer.value is not an instance of HTMLAudioElement")}).catch(r=>{console.log("err: ",r)})};return T({open:m,reset_default:b}),(e,r)=>{const _=s("AppIcon"),V=s("el-button"),k=s("el-dialog");return F(),ee(ae,null,[l(k,{"align-center":"",title:e.$t("common.paramSetting"),class:"aiMode-param-dialog",modelValue:f.value,"onUpdate:modelValue":r[2]||(r[2]=c=>f.value=c),style:{width:"550px"},"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},{footer:a(()=>[d("div",ze,[d("span",Ae,[l(V,{onClick:t,loading:$.value},{default:a(()=>[l(_,{iconName:"app-video-play",class:"mr-4"}),w(" "+u(e.$t("views.application.applicationForm.form.voicePlay.listeningTest")),1)]),_:1},8,["loading"])]),d("span",Te,[l(V,{onClick:r[1]||(r[1]=E(c=>f.value=!1,["prevent"]))},{default:a(()=>[w(u(e.$t("common.cancel")),1)]),_:1}),l(V,{type:"primary",onClick:D,loading:M.value},{default:a(()=>[w(u(e.$t("common.confirm")),1)]),_:1},8,["loading"])])])]),default:a(()=>[l(J,{modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=c=>o.value=c),model:o.value,"label-position":"top","require-asterisk-position":"right",render_data:g.value,ref_key:"dynamicsFormRef",ref:v},null,8,["modelValue","model","render_data"])]),_:1},8,["title","modelValue"]),d("audio",{ref_key:"audioPlayer",ref:n,controls:"",hidden:"hidden"},null,512)],64)}}});const Be=Z(Re,[["__scopeId","data-v-73da63d7"]]);export{xe as A,Be as T,Ie as _,Le as a};
